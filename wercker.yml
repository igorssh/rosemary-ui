box: node:4.2.6-slim

# Build definition
build:
  steps:
    # A step that executes `npm install` command
    - npm-install
    # A step that executes `npm test` command
    - npm-test

deploy:
  steps:
    - script:
        name: saving .npmrc
        code: |
          shopt -s xpg_echo
          echo $NPMRC > ~/.npmrc
    - npm-install
    - script:
        name: version increment
        code: |
          npm set init.author.name "C.T.Co"
          npm set init.author.email "cscm@ctco.lv"
          npm set init.author.url "http://ctco.github.io"
          node_modules/grunt/bin/grunt bump
          npm publish ./

gh-pages:
  steps:
    - script:
        name: saving .npmrc
        code: |
          shopt -s xpg_echo
          echo $NPMRC > ~/.npmrc
    - npm-install
    - script:
        name: publish version
        code: |
          npm run deploy
